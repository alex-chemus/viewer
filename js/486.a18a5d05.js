"use strict";(self["webpackChunkviewer"]=self["webpackChunkviewer"]||[]).push([[486],{2486:function(e,t,s){s.r(t),s.d(t,{default:function(){return re}});s(1703);var a=s(6252),n=s(9669),r=s.n(n),o=s(4870),l=s(8637),i=s(2119),c=s(3577),u=s(651),p=s(7596);const d=(e,t)=>{let s=setTimeout((()=>{}));const a=(...a)=>{clearTimeout(s),s=setTimeout((()=>{e(...a)}),t)};return a};var v=d,m=s(9963);const g={class:"group-list-item p-2"},y={class:"wrapper me-3"},h=["title"],_=["title"],w=(0,a.Uk)("Info");var f=(0,a.aZ)({__name:"PopupItem",props:{item:null},setup(e){const t=(0,i.yj)(),s=(0,o.iH)(t.params.type||"movies");return(t,n)=>{const r=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("li",g,[(0,a._)("div",y,[(0,a._)("h6",{class:"mb-2",title:e.item.title},(0,c.zw)(e.item.title),9,h),(0,a._)("i",{class:"m-0",title:e.item.description},(0,c.zw)(e.item.description),9,_)]),(0,a.Wm)(r,{to:`/${s.value}/${e.item.id}`,class:"btn btn-warning"},{default:(0,a.w5)((()=>[w])),_:1},8,["to"])])}}}),b=s(8118);const S=(0,b.Z)(f,[["__scopeId","data-v-8e7838ee"]]);var k=S;const T={class:"popup"},L={key:0,class:"loader-container"},I={key:1,class:"list-group"};var D=(0,a.aZ)({__name:"Popup",props:{searchedList:null},setup(e){const t=e;(0,a.YP)((()=>t.searchedList),(()=>{console.log("searched list: ",t.searchedList)}));const s=(0,a.Fl)((()=>t.searchedList?t.searchedList.map(((e,t)=>({i:t,...e}))):null));return(e,t)=>((0,a.wg)(),(0,a.iD)("div",T,[(0,o.SU)(s)?(0,o.SU)(s)?((0,a.wg)(),(0,a.iD)("ul",I,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,o.SU)(s),(e=>((0,a.wg)(),(0,a.j4)(k,{key:e.i,item:e},null,8,["item"])))),128))])):(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",L,[(0,a.Wm)((0,o.SU)(p.a),{size:"70"})]))]))}});const H=(0,b.Z)(D,[["__scopeId","data-v-303ccbaf"]]);var $=H;const M=["placeholder"];var Z=(0,a.aZ)({__name:"SearchContent",props:{searchedList:null,isOpened:{type:Boolean},contentType:null},emits:["close-popup","input"],setup(e){const t=e,s=(0,a.Fl)((()=>["backdrop",{"--open":t.isOpened}]));return(t,n)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("form",{onSubmit:n[1]||(n[1]=(0,m.iM)((()=>{}),["prevent"])),ref:"form"},[(0,a._)("input",{type:"text",class:"form-control",placeholder:`Search ${e.contentType}`,onInput:n[0]||(n[0]=e=>t.$emit("input",e))},null,40,M),e.isOpened?((0,a.wg)(),(0,a.j4)($,{key:0,searchedList:e.searchedList},null,8,["searchedList"])):(0,a.kq)("",!0)],544),(0,a._)("div",{class:(0,c.C_)((0,o.SU)(s)),onClick:n[2]||(n[2]=e=>t.$emit("close-popup"))},null,2)],64))}});const j=(0,b.Z)(Z,[["__scopeId","data-v-471b614d"]]);var O=j,U=(0,a.aZ)({__name:"Search",props:{contentType:null},setup(e){const t=e,s=(0,a.f3)("key"),{getters:n}=(0,l.oR)(s),i=(0,o.iH)(null),c=(0,o.iH)(!1),u=(0,o.iH)(!1),p=e=>{const s=e.target;if(""===s.value.trim())return;c.value=!0,u.value=!0;const a=s.value,o="movies"===t.contentType?"SearchMovie":"SearchSeries";r()(`${n.url}/${o}/${n.apiKey}/${a}`).then((e=>{if(e.data.errorMessage?.length||200!==e.status)throw new Error(e.data.errorMessage);c.value=!1,console.log("search data: ",e.data);const t=[];e.data.results.forEach((e=>{t.push({id:e.id,title:e.title,description:e.description,image:e.image,resultType:e.resultType})})),i.value=t})).catch((e=>{console.log(`failed to search ${t.contentType}`,e)}))},d=v(p,1e3),m=()=>{u.value=!1};return(t,s)=>((0,a.wg)(),(0,a.j4)(O,{searchedList:i.value,isOpened:u.value,contentType:e.contentType,onClosePopup:m,onInput:(0,o.SU)(d)},null,8,["searchedList","isOpened","contentType","onInput"]))}});const C=U;var E=C;const P=e=>((0,a.dD)("data-v-25f5326d"),e=e(),(0,a.Cn)(),e),x={class:"container"},z=P((()=>(0,a._)("h2",{class:"mb-3"},"Sorry, but something went wrong",-1))),R=P((()=>(0,a._)("h3",null,"¯\\_(ツ)_/¯",-1))),Y=[z,R];function F(e,t){return(0,a.wg)(),(0,a.iD)("div",x,Y)}const K={},W=(0,b.Z)(K,[["render",F],["__scopeId","data-v-25f5326d"]]);var J=W;const N={key:1,class:"container pt-5"},q={class:"row justify-content-center mb-4"},B={class:"col-xl-6 col-lg-8 col-12"},V={class:"mb-3 text-center"},A={class:"row justify-content-center mb-3"};var G=(0,a.aZ)({__name:"FeedContent",props:{isError:{type:Boolean},cardsList:null,contentType:null},emits:["observe"],setup(e,{emit:t}){const s=(0,o.iH)(null),n=(0,o.iH)(!1),r=new IntersectionObserver((e=>{e.some((e=>e.isIntersecting))&&t("observe")}),{threshold:0,rootMargin:"10px"}),l=()=>{s.value&&!n.value&&(r.observe(s.value),n.value=!0)};return(0,a.bv)(l),(0,a.ic)(l),(t,n)=>e.isError?((0,a.wg)(),(0,a.j4)(J,{key:0})):e.cardsList&&e.cardsList.length>0?((0,a.wg)(),(0,a.iD)("section",N,[(0,a._)("div",q,[(0,a._)("div",B,[(0,a.Wm)((0,o.SU)(E),{contentType:e.contentType},null,8,["contentType"])])]),(0,a._)("h1",V,"Popular "+(0,c.zw)(e.contentType),1),(0,a._)("div",A,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.cardsList,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.i,class:"col-xl-2 col-lg-3 col-sm-4 col-8 py-3"},[(0,a.Wm)((0,o.SU)(u.Z),{data:e.data},null,8,["data"])])))),128))]),(0,a._)("div",{class:"row justify-content-center",ref_key:"divRef",ref:s},null,512)])):((0,a.wg)(),(0,a.j4)((0,o.SU)(p.a),{key:2,size:"180"}))}});const Q=(0,b.Z)(G,[["__scopeId","data-v-33b9bcc5"]]);var X=Q,ee=(0,a.aZ)({__name:"Feed",setup(e){const t=(0,a.f3)("key"),{getters:s}=(0,l.oR)(t),n=(0,i.yj)(),c=(0,i.tv)(),u=(0,o.iH)(null),p=(0,o.iH)(!1),d=(0,o.iH)(21),v=(0,o.iH)(n.params.type),m="movies"===v.value?"popularMovies":"popularSeries",g="movies"===v.value?"MostPopularMovies":"MostPopularTVs",y=async()=>{try{const e=await r().get(`${s.url}/${g}/${s.apiKey}`),t=""!==e.data.errorMessage||200!==e.status;if(t)throw new Error(e.data.errorMessage);const a=[];return e.data.items.forEach(((e,t)=>{a.push({data:{title:e.title,year:e.year,imDbRating:e.imDbRating,image:e.image,id:e.id},i:t})})),u.value=a.slice(0,d.value),localStorage.setItem(m,JSON.stringify({list:a,time:Date.now()})),null}catch(e){return p.value=!0,localStorage.setItem("errorMessage",e),c.push("/error"),null}},h=()=>{if(JSON.parse(localStorage.getItem(m))){const e=JSON.parse(localStorage.getItem(m));u.value=e.list.slice(0,d.value),Date.now()-e.time>36e5&&(console.log("fetch data"),y())}else y()};(0,a.YP)((()=>n.params),h),(0,a.bv)(h);const _=()=>{d.value+=20,h()};return(e,t)=>((0,a.wg)(),(0,a.j4)(X,{cardsList:u.value,isError:p.value,contentType:v.value,onObserve:_},null,8,["cardsList","isError","contentType"]))}});const te=ee;var se=te,ae=se;const ne=ae;var re=ne}}]);
//# sourceMappingURL=486.a18a5d05.js.map